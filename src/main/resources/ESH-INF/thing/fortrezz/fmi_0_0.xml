<?xml version="1.0" encoding="UTF-8"?>
<thing:thing-descriptions bindingId="zwave"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns:thing="https://openhab.org/schemas/thing-description/v1.0.0"
  xsi:schemaLocation="https://openhab.org/schemas/thing-description/v1.0.0
                      https://openhab.org/schemas/thing-description/v1.0.0">

  <thing-type id="fortrezz_fmi_00_000" listed="false">
    <label>FMI Flow Meter</label>
    <description>Flow Meter&lt;br /&gt&lt;h1&gtOverview&lt;/h1&gt&lt;p&gtWith Flow meter, you have the power to automate, manage water consumption, and detect leaks in your home or building.&lt;/p&gt &lt;p&gtThis is an integral part to a complete water management solution.  Flow Meter tracks water usage and reports gallons used.  Track your households water usage and drill into reports to find out where your peak consumption is and make changes to reduce your water bills.&lt;/p&gt &lt;p&gtFlow meter tells you if water is flowing or if it’s off.  It knows if the flow is small, like a running toilet, or if it’s large, like a garden hose left on.&lt;/p&gt &lt;p&gtFlow meter can detect leaks or fixtures left on.  It tracks usage and allows you create smart triggers using your Z-wave home automation system.  To add to it’s capabilities, flow meter checks the temperature in the nearby surrounds to detect for freezing conditions and sends temperature alerts.&lt;/p&gt &lt;p&gtThere’s also a backup battery, just in case power is interrupted.  You won’t have to worry about lost data or lack of leak monitoring.  Plumbed on the water main, flow meter is sure to be a valuable part of your total home automation &amp;amp; leak prevention system.&lt;/p&gt &lt;br /&gt&lt;h2&gtInclusion Information&lt;/h2&gt&lt;ol&gt&lt;li&gtSet up  the  inclusion  mode  at  the  controller;&lt;/li&gt &lt;li&gtPress  the  switch  once  and  the  controller  will indicate the unit has been included in the network.  Also, the LED will blink when the inclusion completes. &lt;/li&gt &lt;/ol&gt&lt;br /&gt&lt;h2&gtExclusion Information&lt;/h2&gt&lt;ol&gt&lt;li&gtSet up the exclusion mode at the controller;&lt;/li&gt &lt;li&gtBriefly press the switch once and then release.  The controller will indicate the unit has been removed from the network.  The LED will blink when the exclusion completes.&lt;/li&gt &lt;/ol&gt</description>
    <category>Sensor</category>

    <!-- CHANNEL DEFINITIONS -->
    <channels>
      <channel id="sensor_binary" typeId="sensor_binary">
        <label>Binary Sensor</label>
        <properties>
          <property name="binding:*:OnOffType">COMMAND_CLASS_SENSOR_BINARY</property>
        </properties>
      </channel>
      <channel id="sensor_temperature" typeId="sensor_temperature">
        <label>Sensor (temperature)</label>
        <properties>
          <property name="binding:*:QuantityType">COMMAND_CLASS_SENSOR_MULTILEVEL;type=TEMPERATURE</property>
        </properties>
      </channel>
      <channel id="sensor_general" typeId="sensor_general">
        <label>Sensor (general)</label>
        <properties>
          <property name="binding:*:DecimalType">COMMAND_CLASS_SENSOR_MULTILEVEL;type=GENERAL</property>
        </properties>
      </channel>
      <channel id="meter_water_gallons" typeId="meter_water_gallons">
        <label>Water meter (amps)</label>
        <properties>
          <property name="binding:*:DecimalType">COMMAND_CLASS_METER;type=W_Gallons</property>
        </properties>
      </channel>
      <channel id="alarm_heat" typeId="alarm_heat">
        <label>Alarm (heat)</label>
        <properties>
          <property name="binding:*:OnOffType">COMMAND_CLASS_ALARM;type=HEAT</property>
        </properties>
      </channel>
      <channel id="alarm_flood" typeId="alarm_flood">
        <label>Alarm (flood)</label>
        <properties>
          <property name="binding:*:OnOffType">COMMAND_CLASS_ALARM;type=FLOOD</property>
        </properties>
      </channel>
      <channel id="alarm_power" typeId="alarm_power">
        <label>Alarm (power)</label>
        <properties>
          <property name="binding:*:OnOffType">COMMAND_CLASS_ALARM;type=POWER_MANAGEMENT</property>
        </properties>
      </channel>
      <channel id="battery-level" typeId="system.battery-level">
        <properties>
          <property name="binding:*:PercentType">COMMAND_CLASS_BATTERY</property>
        </properties>
      </channel>
    </channels>

    <!-- DEVICE PROPERTY DEFINITIONS -->
    <properties>
      <property name="vendor">FortrezZ LLC</property>
      <property name="modelId">FMI</property>
      <property name="manufacturerId">0084</property>
      <property name="manufacturerRef">0473:0110</property>
      <property name="dbReference">934</property>
      <property name="defaultAssociations">1</property>
    </properties>

    <!-- CONFIGURATION DESCRIPTIONS -->
    <config-description>

      <!-- GROUP DEFINITIONS -->
      <parameter-group name="configuration">
        <context>setup</context>
        <label>Configuration Parameters</label>
      </parameter-group>

      <parameter-group name="association">
        <context>link</context>
        <label>Association Groups</label>
      </parameter-group>

      <!-- PARAMETER DEFINITIONS -->
      <parameter name="config_1_1" type="integer" groupName="configuration"
                 min="-10" max="69">
        <label>1: Temperature Low Threshold</label>
        <description>Temperature Low Threshold</description>
        <default>4</default>
      </parameter>

      <parameter name="config_2_1" type="integer" groupName="configuration"
                 min="-9" max="70">
        <label>2: Temperature High Threshold</label>
        <description>Temperature High Threshold</description>
        <default>70</default>
      </parameter>

      <parameter name="config_3_4" type="integer" groupName="configuration"
                 min="0" max="99999999">
        <label>3: Meter Count</label>
        <description>Meter Count&lt;br /&gt&lt;h1&gtOverview&lt;/h1&gt&lt;p&gt&amp;lt;p&amp;amp;gtCount rolls over at 99,999,999&amp;lt;/p&amp;amp;gt&lt;/p&gt</description>
        <default>0</default>
      </parameter>

      <parameter name="config_4_1" type="integer" groupName="configuration"
                 min="0" max="255">
        <label>4: Meter Report Interval</label>
        <description>Meter Report Interval&lt;br /&gt&lt;h1&gtOverview&lt;/h1&gt&lt;p&gt&amp;lt;p&amp;amp;gtMeter Report Interval, &amp;lt;strong&amp;amp;gtwhile liquid flow is detected&amp;lt;/strong&amp;amp;gt.  If 0 is set, then no continuous reporting during liquid flow.  Note:  Report is sent every 10 hours whether or not flow is detected.&amp;lt;/p&amp;amp;gt &amp;lt;p&amp;amp;gtDefault is 6, which is 60 seconds.&amp;lt;/p&amp;amp;gt&lt;/p&gt</description>
        <default>6</default>
      </parameter>

      <parameter name="config_5_2" type="integer" groupName="configuration"
                 min="0" max="65535">
        <label>5: Meter Leak Threshold</label>
        <description>Meter Leak Threshold&lt;br /&gt&lt;h1&gtOverview&lt;/h1&gt&lt;p&gt&amp;lt;p&amp;amp;gtMeter Leak Threshold.  Set the threshold count for reporting Flow vs High Flow.  Default is set to 50 (5 gallons).&amp;lt;/p&amp;amp;gt &amp;lt;p&amp;amp;gtFlow above 5 gallons/min sends (Above Threshold / 255)&amp;lt;/p&amp;amp;gt &amp;lt;p&amp;amp;gtFlow below 5 gallons/min sends (Below Threshold / 128)&amp;lt;/p&amp;amp;gt &amp;lt;p&amp;amp;gtNote: If MLS enabled, Value of 0 = No flow detected (during interval)&amp;lt;/p&amp;amp;gt&lt;/p&gt</description>
        <default>50</default>
      </parameter>

      <parameter name="config_6_1" type="integer" groupName="configuration"
                 min="0" max="255">
        <label>6: Notification Commands MLS</label>
        <description>Toggle Commands or MLS&lt;br /&gt&lt;h1&gtOverview&lt;/h1&gt&lt;p&gt&amp;lt;p&amp;amp;gtNotification Commands vs Multi-Level Sensor Toggle.&amp;lt;/p&amp;amp;gt &amp;lt;p&amp;amp;gtNotifications set as default - Value &quot;0&quot;&amp;lt;/p&amp;amp;gt &amp;lt;p&amp;amp;gtTo enable MLS - Value set to any number except 0&amp;lt;/p&amp;amp;gt&lt;/p&gt</description>
        <default>0</default>
      </parameter>

      <!-- ASSOCIATION DEFINITIONS -->
      <parameter name="group_1" type="text" groupName="association" multiple="true">
        <label>1: Lifeline</label>
        <description>Lifeline&lt;br /&gt&lt;h1&gtOverview&lt;/h1&gt&lt;p&gtThe controller should automatically set up this association.&lt;/p&gt &lt;ul&gt&lt;li&gtDevice Reset Locally (via 3 quick presses of the program switch)&lt;/li&gt &lt;li&gtMultilevel Sensor Temperature Report&lt;/li&gt &lt;li&gtMeter Pulse Report (flow count)&lt;/li&gt &lt;li&gtNotifications &lt;ul&gt&lt;li&gtUnder temperature detected&lt;/li&gt &lt;li&gtOver temperature detected&lt;/li&gt &lt;li&gtPower (Voltage Drop/Droop)&lt;/li&gt &lt;/ul&gt&lt;/li&gt &lt;/ul&gt</description>
        <multipleLimit>5</multipleLimit>
      </parameter>

      <parameter name="group_2" type="text" groupName="association" multiple="true">
        <label>2: High Temperature</label>
        <description>&lt;br /&gt&lt;h1&gtOverview&lt;/h1&gt&lt;p&gtBasic Set Command with value = 0xFF is sent to the associated nodes to indicate that a Temperature High condition has been detected.  When the temperature is back in the normal range, one additional report with value = 0x00 is sent.&lt;/p&gt</description>
        <multipleLimit>5</multipleLimit>
      </parameter>

      <parameter name="group_3" type="text" groupName="association" multiple="true">
        <label>3: Low Temperature</label>
        <description>&lt;br /&gt&lt;h1&gtOverview&lt;/h1&gt&lt;p&gtBasic Set Command with value = 0xFF is sent to the associated nodes to indicate that a Temperature Low condition has been detected.  When the temperature is back in the normal range, one additional report with value = 0x00 is sent.&lt;/p&gt</description>
        <multipleLimit>5</multipleLimit>
      </parameter>

      <parameter name="group_4" type="text" groupName="association" multiple="true">
        <label>4: Flow Detected</label>
        <description>&lt;br /&gt&lt;h1&gtOverview&lt;/h1&gt&lt;p&gtBasic Set Command with value = 0xFF is sent when the meter count is incremented (i.e., flow has started).&lt;/p&gt &lt;p&gtDo not set associations for this group if water flow is expected.  When flow is not expected (for example, at a vacant vacation home), this association group can be set to perform various tasks such as commanding a water valve to open in order to stop the flow of water and/or commanding a siren/strobe unit to activate.  Since the Basic Set Command (value 0xFF) is sent every 30 seconds while the water is flowing; this commanding should be turned off by removing the associations in this group if water flow is normally expected.&lt;/p&gt &lt;p&gtNote that no command is ever sent with a value of 0x00 because the FMI cannot know if or when conditions have returned to normal.&lt;/p&gt</description>
        <multipleLimit>5</multipleLimit>
      </parameter>

      <!-- STATIC DEFINITIONS -->
      <parameter name="node_id" type="integer" min="1" max="232" readOnly="true" required="true">
        <label>Node ID</label>
        <advanced>true</advanced>
      </parameter>

    </config-description>

  </thing-type>

</thing:thing-descriptions>
